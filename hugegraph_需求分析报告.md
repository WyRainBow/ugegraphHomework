# HugeGraph 毕业文章和投票统计 - 需求分析报告

## 一、项目背景

Apache HugeGraph 项目成功完成从 Apache 孵化器毕业的投票，现在需要：
1. 撰写一篇公众号风格的毕业庆祝文章
2. 统计并展示投票结果，按维度分组展示

## 二、核心需求

### 2.1 任务1：毕业文章撰写

#### 目标
创建一篇综合全面的公众号风格文章，庆祝 HugeGraph 从 Apache 孵化器成功毕业为顶级项目（TLP）。

#### 内容要求
- **文章正文**（综合全面）
  - 项目简介（HugeGraph是什么）
  - 孵化历程回顾（2022年1月-2026年1月）
  - 关键成就亮点：
    - 社区成长（210+贡献者，10位新committer，2位新PPMC成员）
    - 版本发布（5个Apache版本 1.0-1.7，5位发布经理）
    - 生产应用（金融、电商、电信等行业）
    - 生态系统（与SeaTunnel、TinkerPop集成，参与GSoC和OSPP）
    - 治理合规（PMC成员确认，遵循ASF政策）
  - 投票结果总结
  - 致谢和展望

- **数据可视化**（新增要求）
  - 社区贡献趋势图（贡献者数量随时间变化）
  - 版本发布时间线图（5个版本的发布时间）
  - 投票分布图表（饼图/柱状图）

- **引用金句**（新增要求）
  - 从投票邮件中摘录推荐语和正面评价
  - 如："Good luck", "Congrats", "Best wishes"等

- **链接集合**（新增要求）
  - 官网：https://hugegraph.apache.org
  - GitHub：https://github.com/apache/incubator-hugegraph
  - 项目状态页
  - 投票线程链接
  - 相关讨论链接

- **封面图/主题图**
  - 工具：Google Nanobraow
  - 准备2-3个备选设计方案
  - 包含官方Logo和品牌色
  - 尺寸：1200x630px

### 2.2 任务2：投票结果统计

#### 数据源
- **链接**：https://lists.apache.org/thread/djkxttgpj08v74r8rqdv3np856g3krlr
- **数据格式**：Apache Pony Mail JSON API

#### 提取要求
- 投票人姓名（从邮件from字段）
- 投票值（+1 / +0 / -1）
- 绑定类型（binding / non-binding）
- 投票时间戳（从epoch字段转换）
- 原始投票内容（用于验证和提取金句）

#### 分组维度
经过分析投票数据，主要分组维度为：
- **主要维度**：绑定类型
  - **Binding**：有决定权的投票（IPMC成员投票）
  - **Non-Binding**：意见性投票（社区成员等）
- **次要维度**：投票值
  - **+1**：支持毕业
  - **+0**：无意见
  - **-1**：反对（需提供理由）

#### 统计输出
- 分组统计表格（Binding/Non-Binding × +1/+0/-1）
- 各分组投票人列表
- 总投票数统计
- 时间分布统计

## 三、技术方案

### 3.1 投票数据提取方案

#### 数据源访问
- **方法**：直接调用Apache Pony Mail JSON API（无需浏览器自动化）
- **API端点**：
  - 线程信息：`https://lists.apache.org/api/thread.lua?id={thread_id}`
  - 单封邮件：`https://lists.apache.org/api/email.lua?id={email_id}`

#### 提取流程
1. 调用thread API获取线程结构和所有邮件ID（递归遍历children数组）
2. 批量调用email API获取每封邮件的详细信息
3. 使用正则表达式从`body`字段提取投票信息：
   - 投票值：`^\s*[+\-]?1\s*`，`^\s*\+0\s*`（匹配+1, -1, +0）
   - 绑定类型：`\(?binding\)?`，`\(?non-?binding\)?`（匹配binding/non-binding）
   - 处理格式变体：`+1 binding`, `+1(binding)`, `+1 binding kirs`等
4. 提取元数据：
   - 投票人：从`from`字段解析姓名和邮箱
   - 时间戳：从`epoch`字段转换为可读日期
   - 邮件ID：用于生成直接链接

#### 数据清洗
- 过滤非投票邮件（讨论、回复等）
- 去重处理（同一人多次投票的情况）
- 格式标准化（统一投票值表示方式）
- 验证数据完整性

### 3.2 封面图生成方案

#### 工具选择
- **主要工具**：Google Nanobraow（图像生成AI工具）

#### 设计方案（3个备选）

**方案1 - 正式庄重**
- 主视觉：Apache羽毛标志 + HugeGraph Logo
- 主题文字："Apache HugeGraph 正式毕业为顶级项目"
- 副标题："2022-2026 | 孵化成功"
- 配色：Apache品牌红 + HugeGraph品牌色
- 风格：正式、权威、庆祝

**方案2 - 现代科技**
- 主视觉：图形化元素（网络图、节点连接）
- 主题文字："HugeGraph Graduates from Apache Incubator"
- 背景：科技感渐变
- 风格：现代、动态、创新

**方案3 - 简洁庆祝**
- 主视觉：大号"GRADUATION"文字
- 副标题：项目名称和毕业日期
- 装饰：简洁图标元素
- 风格：简洁、醒目、专业

#### 技术规格
- 尺寸：1200x630px（社交媒体标准尺寸）
- 格式：PNG（支持透明）或JPG
- 包含元素：官方Logo、品牌色、清晰文字

### 3.3 数据可视化方案

#### 工具选择
- Python matplotlib 或 plotly
- 生成PNG图片嵌入文章

#### 图表类型
1. **社区贡献趋势图**
   - 类型：折线图
   - X轴：时间（月份）
   - Y轴：贡献者数量
   - 展示社区成长轨迹

2. **版本发布时间线图**
   - 类型：时间线图
   - 标注5个Apache版本（1.0-1.7）
   - 显示版本号和发布时间

3. **投票分布图表**
   - 类型：饼图或柱状图
   - 展示Binding vs Non-Binding分布
   - 展示+1/+0/-1分布

## 四、实施计划

### 阶段1：数据收集与分析（1-2小时）
1. 编写Python脚本调用JSON API
2. 实现投票数据提取逻辑（正则表达式）
3. 数据清洗和验证
4. 按分组维度组织数据

### 阶段2：投票统计生成（1小时）
1. 生成分组统计表格
2. 创建投票人列表
3. 计算汇总数据
4. 生成统计报告文档

### 阶段3：文章撰写（2-3小时）
1. 收集项目相关信息
2. 生成数据可视化图表
3. 提取投票邮件中的引用金句
4. 撰写文章各部分内容
5. 整合所有内容（统计、图表、引用、链接）
6. 润色和格式调整

### 阶段4：封面图生成（1-2小时）
1. 使用Nanobraow生成3个备选方案
2. 对比选择最适合的设计
3. 微调细节
4. 输出最终版本

### 阶段5：输出整理（0.5小时）
1. 整理所有输出文件
2. 创建实现说明文档
3. 质量检查和最终确认

## 五、预期输出

### 文档类
1. `hugegraph_graduation_article.md` - 毕业文章正文（包含所有章节、图表、引用、链接）
2. `vote_statistics.md` - 投票统计报告（分组表格和详细列表）
3. `implementation_guide.md` - 实现说明文档（API调用、正则表达式、数据处理流程）

### 图片类
1. `hugegraph_cover_image.png` - 最终选定的封面图
2. `hugegraph_cover_alternatives/` - 封面图备选方案文件夹
   - `cover_option_1.png` - 正式庄重风格
   - `cover_option_2.png` - 现代科技风格
   - `cover_option_3.png` - 简洁庆祝风格
3. `data_visualizations/` - 数据可视化图表文件夹
   - `community_growth_trend.png` - 社区贡献趋势图
   - `release_timeline.png` - 版本发布时间线
   - `vote_distribution.png` - 投票分布图

### 数据类
1. `vote_data.json` - 原始投票数据（JSON格式，便于后续分析和验证）

## 六、技术难点与解决方案

### 难点1：投票格式多样化
**问题**：投票邮件格式不统一（+1 binding, +1(binding), +1 binding kirs等）
**解决方案**：使用灵活的正则表达式模式，匹配多种格式变体

### 难点2：邮件嵌套结构
**问题**：邮件有回复嵌套关系（children数组）
**解决方案**：递归遍历children数组，确保提取所有相关邮件

### 难点3：数据去重
**问题**：同一人可能多次回复
**解决方案**：根据from字段和时间戳，识别同一人的多个投票，取最早或最完整的记录

### 难点4：绑定类型识别
**问题**：需要准确区分binding和non-binding
**解决方案**：通过邮件内容和IPMC成员名单对比，或根据邮件明确标注判断

## 七、成功标准

1. ✅ 准确提取所有投票数据（无遗漏、无错误）
2. ✅ 正确分组统计（维度清晰、数据准确）
3. ✅ 文章内容全面、专业、易读
4. ✅ 数据可视化清晰、美观
5. ✅ 封面图设计符合品牌规范，有备选方案
6. ✅ 所有链接可访问，引用准确
7. ✅ 输出文件结构清晰，易于使用

---

**报告日期**：2026年1月  
**需求分析人**：AI Assistant  
**状态**：待执行