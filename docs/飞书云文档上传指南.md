# 飞书云文档上传指南

## 一、获取飞书 API 凭证

### 步骤1：访问飞书开放平台

1. 打开浏览器，访问：https://open.feishu.cn/
2. 使用你的飞书账号登录

### 步骤2：创建应用

1. 登录后，点击右上角的 **"控制台"** 或 **"开发者后台"**
2. 在左侧菜单找到 **"应用管理"** 或 **"我的应用"**
3. 点击 **"创建企业自建应用"** 或 **"新建应用"**
4. 填写应用信息：
   - **应用名称**：例如 "Apache HugeGraph 文档管理"
   - **应用描述**：可选
   - **应用图标**：可选
5. 点击 **"创建"**

### 步骤3：获取 App ID 和 App Secret

1. 在应用详情页面，找到 **"凭证与基础信息"** 或 **"应用凭证"** 标签页
2. 你会看到：
   - **App ID**：一串类似 `cli_xxxxxxxxxxxxx` 的字符串
   - **App Secret**：一串类似 `xxxxxxxxxxxxxxxxxxxxxxxxxxxx` 的字符串
3. 点击 **"显示"** 或 **"查看"** 按钮查看 App Secret（首次查看可能需要验证）

### 步骤4：配置应用权限

1. 在应用详情页面，找到 **"权限管理"** 或 **"API 权限"** 标签页
2. 需要开启以下权限：
   - **云文档** → **查看、编辑、管理云文档**
   - **云文档** → **创建文档**
   - **云文档** → **查看、编辑和管理云空间中所有文件**
3. 点击 **"申请权限"** 或 **"开启权限"**
4. 等待管理员审批（如果是企业应用）

### 步骤5：发布应用（可选）

- 如果是个人应用，通常可以直接使用
- 如果是企业应用，可能需要发布到企业应用商店

## 二、使用 API 凭证

### 方式1：通过环境变量

在 `.env` 文件中添加：

```bash
FEISHU_APP_ID=cli_xxxxxxxxxxxxx
FEISHU_APP_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 方式2：通过命令行参数

```bash
python scripts/upload_to_feishu.py \
  --app-id cli_xxxxxxxxxxxxx \
  --app-secret xxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 方式3：直接使用 Token（如果已有）

如果你已经有 `tenant_access_token`，可以直接使用：

```bash
python scripts/upload_to_feishu.py --token YOUR_TENANT_ACCESS_TOKEN
```

## 三、常见问题

### Q: 找不到"应用管理"入口？

A: 确保你登录的是飞书开放平台（https://open.feishu.cn/），而不是普通的飞书客户端。如果看不到"应用管理"，可能需要联系企业管理员开通开发者权限。

### Q: App Secret 显示为星号？

A: 点击"显示"或"查看"按钮，可能需要输入密码或进行二次验证。

### Q: 权限申请被拒绝？

A: 需要联系企业管理员审批权限申请，或者使用个人飞书账号创建个人应用。

### Q: 如何获取 tenant_access_token？

A: 如果你有 App ID 和 App Secret，脚本会自动获取 token。你也可以手动调用 API 获取：

```bash
curl -X POST https://open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal \
  -H "Content-Type: application/json" \
  -d '{
    "app_id": "YOUR_APP_ID",
    "app_secret": "YOUR_APP_SECRET"
  }'
```

## 四、快速开始

1. 获取 App ID 和 App Secret（按照上面的步骤）
2. 运行上传脚本：

```bash
python scripts/upload_to_feishu.py \
  --app-id YOUR_APP_ID \
  --app-secret YOUR_APP_SECRET
```

3. 脚本会自动：
   - 获取 access token
   - 创建飞书云文档
   - 上传所有思路和 prompt 文件
   - 返回文档链接

## 五、上传的文件列表

脚本会上传以下文件到飞书云文档：

1. **实现思路和 Prompt 说明** (`docs/实现思路和Prompt说明.md`)
2. **文章生成 Prompt** (`config/prompts/article_generation.md`)
3. **大纲生成 Prompt** (`config/prompts/outline_generation.md`)
4. **引用提取 Prompt** (`config/prompts/quote_extraction.md`)
5. **实现检查报告** (`docs/实现检查报告.md`)
